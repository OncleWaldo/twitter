{% extends 'base.html.twig' %}

{% block title %}Crypto page{% endblock %}
{% block body %}
  <h1>Bienvenue</h1>
    <ul class="list-group list-group-horizontal-md">
      <li class="list-group-item"> <strong id="symbol">{{ prevday.symbol }}</strong></li>
      <li class="list-group-item">Dernier Achat : <strong id="lastprice">{{ prevday.lastPrice}}</strong></li>
      <li class="list-group-item">Prix demandé : <strong id="bidprice">{{ prevday.bidPrice }}</strong></li>
      <li class="list-group-item">Prix proposé : <strong id="askprice">{{ prevday.askPrice }}</strong></li>
    </ul>

  <table class="table table-striped table-dark">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Symbol</th>
      <th scope="col">Price</th>

    </tr>
  </thead>
  <tbody>
  {% for key , price in pricelist  %}
    <tr>
      <th scope="row">{{loop.index}}</th>
      <td>{{key}}</td>
      <td id="{{key}}_price">{{price}}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<script>
 
    document.addEventListener('DOMContentLoaded', function() {
      setInterval(function(){
        $.get("/prevday").then(function(response){
          $("#lastprice").html(response.data.lastPrice)
          $("#bidprice").html(response.data.bidPrice)
          $("#askprice").html(response.data.askPrice)
        })
      }, 5000)
    })
</script>
<script>
 
    document.addEventListener('DOMContentLoaded', function() {
      setInterval(function(){
        $.get("/pricelist").then(function(response){
          const data = response.data
          Object.keys(data).forEach(key=>{
            $("#" + key + "_price").html(data[key])  
          });  
        })
      }, 5000)
    })
</script>
{% endblock %}


